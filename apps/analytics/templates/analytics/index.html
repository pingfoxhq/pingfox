{% extends "base.html" %}
{% load static %}

{% block title %}Analytics Dashboard{% endblock %}

{% block content %}
<h1 class="text-3xl font-semibold text-white mb-2">Analytics Dashboard</h1>
<p class="text-sm text-gray-400 mb-8">
  View and analyze your site's performance metrics, traffic sources, and user engagement.
</p>
{% include 'core/partials/dashboard_tab.html' with active_tab="analytics" %}
<!-- Summary Cards -->
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-8">


  <div class="stats shadow bg-base-200 text-white">
    <div class="stat">
      <div class="stat-title text-gray-400">Pageviews</div>
      <div class="stat-value text-primary">8,542</div>
      <div class="stat-desc text-gray-500">↗︎ 13% since last week</div>
    </div>
  </div>
  <div class="stats shadow bg-base-200 text-white">
    <div class="stat">
      <div class="stat-title text-gray-400">Unique Visitors</div>
      <div class="stat-value text-secondary">2,137</div>
      <div class="stat-desc text-gray-500">↘︎ 5% since yesterday</div>
    </div>
  </div>
  <div class="stats shadow bg-base-200 text-white">
    <div class="stat">
      <div class="stat-title text-gray-400">Bounce Rate</div>
      <div class="stat-value text-accent">41%</div>
      <div class="stat-desc text-gray-500">↘︎ 2% since last month</div>
    </div>
  </div>
</div>

<!-- Chart Placeholder -->
<div class="bg-base-200 rounded-xl p-6 mb-8">
  <h2 class="text-lg font-semibold text-white mb-4">Pageviews Over Time</h2>
  <div id="chart-container" class="w-full h-64 bg-gray-800 rounded-lg flex items-center justify-center text-gray-500">
    <!-- Replace this with Chart.js or HTMX dynamic content -->
    Chart goes here
  </div>
</div>

<!-- Traffic Sources -->
<div class="bg-base-200 rounded-xl p-6">
  <h2 class="text-lg font-semibold text-white mb-4">Top Traffic Sources</h2>
  <table class="table table-zebra w-full">
    <thead class="text-gray-400">
      <tr>
        <th>Source</th>
        <th>Visitors</th>
        <th>Pageviews</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Google</td>
        <td>892</td>
        <td>1,234</td>
      </tr>
      <tr>
        <td>Twitter</td>
        <td>523</td>
        <td>847</td>
      </tr>
      <tr>
        <td>Direct</td>
        <td>411</td>
        <td>621</td>
      </tr>
    </tbody>
  </table>
</div>
<div class="bg-base-200 rounded-xl p-4 border border-base-300">
  <div class="flex items-center justify-between mb-2">
    <h2 class="text-sm font-semibold text-gray-300">Tracking Script</h2>
    <div class="tooltip tooltip-left" data-tip="Copied!" x-show="copied" x-transition>
      <button class="btn btn-sm btn-outline btn-accent" onclick="copyTrackingCode()" x-data="{ copied: false }" x-init="
        window.copyTrackingCode = () => {
          const code = document.getElementById('tracking-script').innerText;
          navigator.clipboard.writeText(code).then(() => {
            copied = true;
            setTimeout(() => copied = false, 1500);
          });
        }">
        Copy
      </button>
    </div>
  </div>

  <pre class="bg-gray-900 text-xs text-gray-200 p-3 rounded-lg overflow-x-auto" id="tracking-script">
&lt;script defer src="https://cdn.pingfox.io/pf.js" data-site="your-site-id"&gt;&lt;/script&gt;
  </pre>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('chart-container').getContext('2d');
  const myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
      datasets: [{
        label: 'Pageviews',
        data: [12, 19, 3, 5, 2],
        borderColor: '#f97316',
        backgroundColor: 'rgba(249, 115, 22, 0.2)',
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
</script>

{% endblock %}